/*******************************************************************************
*   ___   public
*  ¦OUX¦  C
*  ¦/C+¦  OUX/C+ OS
*   ---   kernel
*         interrupt handlers
* ©overcq                on ‟Gentoo Linux 23.0” “x86_64”              2025‒6‒4 K
*******************************************************************************/
_private void E_interrupt_I_exeception_de(void);
_private void E_interrupt_I_exeception_db(void);
_private void E_interrupt_I_exeception_nmi(void);
_private void E_interrupt_I_exeception_bp(void);
_private void E_interrupt_I_exeception_of(void);
_private void E_interrupt_I_exeception_br(void);
_private void E_interrupt_I_exeception_ud(void);
_private void E_interrupt_I_exeception_nm(void);
_private void E_interrupt_I_exeception_df(void);
_private void E_interrupt_I_exeception_mf(void);
_private void E_interrupt_I_exeception_ts(void);
_private void E_interrupt_I_exeception_np(void);
_private void E_interrupt_I_exeception_ss(void);
_private void E_interrupt_I_exeception_gp(void);
_private void E_interrupt_I_exeception_pf(void);
_private void E_interrupt_I_exeception_mf(void);
_private void E_interrupt_I_exeception_ac(void);
_private void E_interrupt_I_exeception_mc(void);
_private void E_interrupt_I_exeception_xm(void);
_private void E_interrupt_I_exeception_ve(void);
_private void E_interrupt_I_exeception_cp(void);
_private void E_interrupt_I_external_32(void);
_private void E_interrupt_I_external_33(void);
_private void E_interrupt_I_external_34(void);
_private void E_interrupt_I_external_35(void);
_private void E_interrupt_I_external_36(void);
_private void E_interrupt_I_external_37(void);
_private void E_interrupt_I_external_38(void);
_private void E_interrupt_I_external_39(void);
_private void E_interrupt_I_external_40(void);
_private void E_interrupt_I_external_41(void);
_private void E_interrupt_I_external_42(void);
_private void E_interrupt_I_external_43(void);
_private void E_interrupt_I_external_44(void);
_private void E_interrupt_I_external_45(void);
_private void E_interrupt_I_external_46(void);
_private void E_interrupt_I_external_47(void);
_private void E_interrupt_I_external_48(void);
_private void E_interrupt_I_external_49(void);
_private void E_interrupt_I_external_50(void);
_private void E_interrupt_I_external_51(void);
_private void E_interrupt_I_external_52(void);
_private void E_interrupt_I_external_53(void);
_private void E_interrupt_I_external_54(void);
_private void E_interrupt_I_external_55(void);
_private void E_interrupt_I_external_56(void);
_private void E_interrupt_I_external_57(void);
_private void E_interrupt_I_external_58(void);
_private void E_interrupt_I_external_59(void);
_private void E_interrupt_I_external_60(void);
_private void E_interrupt_I_external_61(void);
_private void E_interrupt_I_external_62(void);
_private void E_interrupt_I_external_63(void);
_private void E_interrupt_I_external_64(void);
_private void E_interrupt_I_external_65(void);
_private void E_interrupt_I_external_66(void);
_private void E_interrupt_I_external_67(void);
_private void E_interrupt_I_external_68(void);
_private void E_interrupt_I_external_69(void);
_private void E_interrupt_I_external_70(void);
_private void E_interrupt_I_external_71(void);
_private void E_interrupt_I_external_72(void);
_private void E_interrupt_I_external_73(void);
_private void E_interrupt_I_external_74(void);
_private void E_interrupt_I_external_75(void);
_private void E_interrupt_I_external_76(void);
_private void E_interrupt_I_external_77(void);
_private void E_interrupt_I_external_78(void);
_private void E_interrupt_I_external_79(void);
_private void E_interrupt_I_external_80(void);
_private void E_interrupt_I_external_81(void);
_private void E_interrupt_I_external_82(void);
_private void E_interrupt_I_external_83(void);
_private void E_interrupt_I_external_84(void);
_private void E_interrupt_I_external_85(void);
_private void E_interrupt_I_external_86(void);
_private void E_interrupt_I_external_87(void);
_private void E_interrupt_I_external_88(void);
_private void E_interrupt_I_external_89(void);
_private void E_interrupt_I_external_90(void);
_private void E_interrupt_I_external_91(void);
_private void E_interrupt_I_external_92(void);
_private void E_interrupt_I_external_93(void);
_private void E_interrupt_I_external_94(void);
_private void E_interrupt_I_external_95(void);
_private void E_interrupt_I_external_96(void);
_private void E_interrupt_I_external_97(void);
_private void E_interrupt_I_external_98(void);
_private void E_interrupt_I_external_99(void);
_private void E_interrupt_I_external_100(void);
_private void E_interrupt_I_external_101(void);
_private void E_interrupt_I_external_102(void);
_private void E_interrupt_I_external_103(void);
_private void E_interrupt_I_external_104(void);
_private void E_interrupt_I_external_105(void);
_private void E_interrupt_I_external_106(void);
_private void E_interrupt_I_external_107(void);
_private void E_interrupt_I_external_108(void);
_private void E_interrupt_I_external_109(void);
_private void E_interrupt_I_external_110(void);
_private void E_interrupt_I_external_111(void);
_private void E_interrupt_I_external_112(void);
_private void E_interrupt_I_external_113(void);
_private void E_interrupt_I_external_114(void);
_private void E_interrupt_I_external_115(void);
_private void E_interrupt_I_external_116(void);
_private void E_interrupt_I_external_117(void);
_private void E_interrupt_I_external_118(void);
_private void E_interrupt_I_external_119(void);
_private void E_interrupt_I_external_120(void);
_private void E_interrupt_I_external_121(void);
_private void E_interrupt_I_external_122(void);
_private void E_interrupt_I_external_123(void);
_private void E_interrupt_I_external_124(void);
_private void E_interrupt_I_external_125(void);
_private void E_interrupt_I_external_126(void);
_private void E_interrupt_I_external_127(void);
_private void E_interrupt_I_external_128(void);
_private void E_interrupt_I_external_129(void);
_private void E_interrupt_I_external_130(void);
_private void E_interrupt_I_external_131(void);
_private void E_interrupt_I_external_132(void);
_private void E_interrupt_I_external_133(void);
_private void E_interrupt_I_external_134(void);
_private void E_interrupt_I_external_135(void);
_private void E_interrupt_I_external_136(void);
_private void E_interrupt_I_external_137(void);
_private void E_interrupt_I_external_138(void);
_private void E_interrupt_I_external_139(void);
_private void E_interrupt_I_external_140(void);
_private void E_interrupt_I_external_141(void);
_private void E_interrupt_I_external_142(void);
_private void E_interrupt_I_external_143(void);
_private void E_interrupt_I_external_144(void);
_private void E_interrupt_I_external_145(void);
_private void E_interrupt_I_external_146(void);
_private void E_interrupt_I_external_147(void);
_private void E_interrupt_I_external_148(void);
_private void E_interrupt_I_external_149(void);
_private void E_interrupt_I_external_150(void);
_private void E_interrupt_I_external_151(void);
_private void E_interrupt_I_external_152(void);
_private void E_interrupt_I_external_153(void);
_private void E_interrupt_I_external_154(void);
_private void E_interrupt_I_external_155(void);
_private void E_interrupt_I_external_156(void);
_private void E_interrupt_I_external_157(void);
_private void E_interrupt_I_external_158(void);
_private void E_interrupt_I_external_159(void);
_private void E_interrupt_I_external_160(void);
_private void E_interrupt_I_external_161(void);
_private void E_interrupt_I_external_162(void);
_private void E_interrupt_I_external_163(void);
_private void E_interrupt_I_external_164(void);
_private void E_interrupt_I_external_165(void);
_private void E_interrupt_I_external_166(void);
_private void E_interrupt_I_external_167(void);
_private void E_interrupt_I_external_168(void);
_private void E_interrupt_I_external_169(void);
_private void E_interrupt_I_external_170(void);
_private void E_interrupt_I_external_171(void);
_private void E_interrupt_I_external_172(void);
_private void E_interrupt_I_external_173(void);
_private void E_interrupt_I_external_174(void);
_private void E_interrupt_I_external_175(void);
_private void E_interrupt_I_external_176(void);
_private void E_interrupt_I_external_177(void);
_private void E_interrupt_I_external_178(void);
_private void E_interrupt_I_external_179(void);
_private void E_interrupt_I_external_180(void);
_private void E_interrupt_I_external_181(void);
_private void E_interrupt_I_external_182(void);
_private void E_interrupt_I_external_183(void);
_private void E_interrupt_I_external_184(void);
_private void E_interrupt_I_external_185(void);
_private void E_interrupt_I_external_186(void);
_private void E_interrupt_I_external_187(void);
_private void E_interrupt_I_external_188(void);
_private void E_interrupt_I_external_189(void);
_private void E_interrupt_I_external_190(void);
_private void E_interrupt_I_external_191(void);
_private void E_interrupt_I_external_192(void);
_private void E_interrupt_I_external_193(void);
_private void E_interrupt_I_external_194(void);
_private void E_interrupt_I_external_195(void);
_private void E_interrupt_I_external_196(void);
_private void E_interrupt_I_external_197(void);
_private void E_interrupt_I_external_198(void);
_private void E_interrupt_I_external_199(void);
_private void E_interrupt_I_external_200(void);
_private void E_interrupt_I_external_201(void);
_private void E_interrupt_I_external_202(void);
_private void E_interrupt_I_external_203(void);
_private void E_interrupt_I_external_204(void);
_private void E_interrupt_I_external_205(void);
_private void E_interrupt_I_external_206(void);
_private void E_interrupt_I_external_207(void);
_private void E_interrupt_I_external_208(void);
_private void E_interrupt_I_external_209(void);
_private void E_interrupt_I_external_210(void);
_private void E_interrupt_I_external_211(void);
_private void E_interrupt_I_external_212(void);
_private void E_interrupt_I_external_213(void);
_private void E_interrupt_I_external_214(void);
_private void E_interrupt_I_external_215(void);
_private void E_interrupt_I_external_216(void);
_private void E_interrupt_I_external_217(void);
_private void E_interrupt_I_external_218(void);
_private void E_interrupt_I_external_219(void);
_private void E_interrupt_I_external_220(void);
_private void E_interrupt_I_external_221(void);
_private void E_interrupt_I_external_222(void);
_private void E_interrupt_I_external_223(void);
_private void E_interrupt_I_external_224(void);
_private void E_interrupt_I_external_225(void);
_private void E_interrupt_I_external_226(void);
_private void E_interrupt_I_external_227(void);
_private void E_interrupt_I_external_228(void);
_private void E_interrupt_I_external_229(void);
_private void E_interrupt_I_external_230(void);
_private void E_interrupt_I_external_231(void);
_private void E_interrupt_I_external_232(void);
_private void E_interrupt_I_external_233(void);
_private void E_interrupt_I_external_234(void);
_private void E_interrupt_I_external_235(void);
_private void E_interrupt_I_external_236(void);
_private void E_interrupt_I_external_237(void);
_private void E_interrupt_I_external_238(void);
_private void E_interrupt_I_external_239(void);
_private void E_interrupt_I_external_240(void);
_private void E_interrupt_I_external_241(void);
_private void E_interrupt_I_external_242(void);
_private void E_interrupt_I_external_243(void);
_private void E_interrupt_I_external_244(void);
_private void E_interrupt_I_external_245(void);
_private void E_interrupt_I_external_246(void);
_private void E_interrupt_I_external_247(void);
_private void E_interrupt_I_external_248(void);
_private void E_interrupt_I_external_249(void);
_private void E_interrupt_I_external_250(void);
_private void E_interrupt_I_external_251(void);
_private void E_interrupt_I_external_252(void);
_private void E_interrupt_I_external_253(void);
_private void E_interrupt_I_external_254(void);
_private void E_interrupt_I_external_spurious(void);
//==============================================================================
_private volatile P E_interrupt_Q_local_apic_S_address;
_private volatile P E_interrupt_Q_io_apic_S_address;
_private
struct E_interrupt_Z_gsi
{ N8 source;
  N8 flags;
} *E_interrupt_S_gsi;
_private N8 E_interrupt_S_gsi_n;
_internal N *E_interrupt_S_idt;
_private E_interrupt_S_external_Z *E_interrupt_S_external;
_private N8 E_interrupt_S_gsi_next;
_private N8 E_interrupt_S_gsi_timer;
_private N8 E_interrupt_S_gsi_ipi;
struct __attribute__ ((packed)) E_interrupt_Z_id
{ N32 pad_1;
  N16 pad_2;
  N16 limit;
  N base;
};
_private struct E_interrupt_Z_id E_interrupt_S_id;
//------------------------------------------------------------------------------
_internal N E_interrupt_S_apic_timer_ticks;
_private N E_interrupt_S_cpu_freq;
_private N E_interrupt_S_apic_timer_tick_time;
_internal N E_interrupt_S_apic_timer_freq;
_internal N E_interrupt_S_apic_timer_freq_;
_internal N E_interrupt_S_apic_timer_div;
_internal volatile N E_interrupt_S_rtc_ticks;
//==============================================================================
_internal
N32
E_interrupt_Q_io_apic_R( N8 i
){  *( volatile N32 * )E_interrupt_Q_io_apic_S_address = i;
    return *( volatile N32 * )( (Pc)E_interrupt_Q_io_apic_S_address + 0x10 );
}
_internal
void
E_interrupt_Q_io_apic_P( N8 i
, N32 v
){  *( volatile N32 * )E_interrupt_Q_io_apic_S_address = i;
    *( volatile N32 * )( (Pc)E_interrupt_Q_io_apic_S_address + 0x10 ) = v;
}
_internal
void
E_interrupt_Q_io_apic_P_gsi( N8 i
, N64 v
){  E_interrupt_Q_io_apic_P( 0x10 + i * 2, v & 0xffffffff );
    E_interrupt_Q_io_apic_P( 0x10 + i * 2 + 1, v >> 32 );
}
//------------------------------------------------------------------------------
_private
N32
E_interrupt_Q_local_apic_R( N i
){  return *( volatile N32 * )( E_interrupt_Q_local_apic_S_address + i * 0x10 );
}
_private
void
E_interrupt_Q_local_apic_P( N i
, N32 v
){  *( volatile N32 * )( E_interrupt_Q_local_apic_S_address + i * 0x10 ) = v;
}
//------------------------------------------------------------------------------
_private
void
E_interrupt_I_ipi( N8 processor
, N8 i
){  E_interrupt_Q_local_apic_P( 0x31, processor << 24 );
    E_interrupt_Q_local_apic_P( 0x30, i );
}
_private
void
E_interrupt_I_ipi_startup( N8 processor
, P proc
){  E_interrupt_Q_local_apic_P( 0x31, processor << 24 );
    E_interrupt_Q_local_apic_P( 0x30, ( 6 << 8 ) | ( (N)proc >> 12 ));
}
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#define E_interrupt_Q_io_apic_J_gsi_v( vector, delivery_mode, polarity, trigger_mode, mask, destination ) \
    ( (vector) | ( (N)( delivery_mode ) << 8 ) | ( (N)(polarity) << 13 ) | ( (N)( trigger_mode ) << 15 ) | ( (N)(mask) << 16 ) | ( (N)(destination) << 56 ))
_private
void
E_interrupt_Q_io_apic_I_enable( N8 i
){  N polarity = ( E_interrupt_S_gsi[i].flags & 3 ) == 1 ? 0 : 1;
    N trigger_mode = (( E_interrupt_S_gsi[i].flags >> 2 ) & 3 ) == 3 ? 1 : 0;
    E_interrupt_Q_io_apic_P_gsi( i, E_interrupt_Q_io_apic_J_gsi_v( 32 + i, 0, polarity, trigger_mode, 0, 0 ));
}
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
_private
void
E_interrupt_P( N8 irq
, E_interrupt_S_external_Z proc
){  for_n( i, E_interrupt_S_gsi_n )
        if( E_interrupt_S_gsi[i].source == irq )
        {   E_interrupt_S_external[i] = proc;
            break;
        }
}
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
_internal
void
E_interrupt_I_apic_timer_interrupt( void
){  E_interrupt_S_apic_timer_ticks++;
}
_internal
void
E_interrupt_I_rtc_interrupt_1( void
){  if( !E_interrupt_S_rtc_ticks )
        E_interrupt_S_cpu_freq = E_flow_I_current_time();
    else if( E_interrupt_S_rtc_ticks == 1 )
        E_interrupt_S_cpu_freq = E_flow_I_current_time() - E_interrupt_S_cpu_freq;
    E_interrupt_S_rtc_ticks++;
    E_main_I_out_8( 0x70, 0xc );
    E_main_I_in_8( 0x71 );
}
_internal
void
E_interrupt_I_rtc_interrupt_2( void
){  if( !E_interrupt_S_rtc_ticks )
        E_interrupt_Q_local_apic_P( 0x38, E_interrupt_S_apic_timer_div );
    else if( E_interrupt_S_rtc_ticks == 1 )
        E_interrupt_S_apic_timer_freq_ = E_interrupt_S_apic_timer_ticks;
    E_interrupt_S_rtc_ticks++;
    E_main_I_out_8( 0x70, 0xc );
    E_main_I_in_8( 0x71 );
}
#define E_interrupt_J_interrupt_descriptor_low( selector, offset, stack ) (( (N)(offset) & (( 1UL << 16 ) - 1 )) | ( (N)(selector) << 16 ) | ( (N)(stack) << 32 ) | ( 0xeUL << ( 32 + 8 )) | ( 1UL << ( 32 + 15 )) | ((( (N)(offset) >> 16 ) & (( 1UL << 16 ) - 1 )) << ( 32 + 16 )))
#define E_interrupt_J_interrupt_descriptor( i, procedure, stack ) \
    {   E_interrupt_S_idt[ (i) * 2 ] = E_interrupt_J_interrupt_descriptor_low( 1 << 3, (N)&(procedure), (stack) ); \
        E_interrupt_S_idt[ (i) * 2 + 1 ] = (N)&(procedure) >> 32; \
    }
_internal
N8
E_interrupt_R_gsi_next( void
){  if( E_interrupt_S_gsi_next < 16 )
    {   N8 i;
        for( i = E_interrupt_S_gsi_next; i != 16; i++ )
            if( !~(S8)E_interrupt_S_gsi[i].source )
                break;
        E_interrupt_S_gsi_next = i;
    }
    if( E_interrupt_S_gsi_next == E_interrupt_S_gsi_n )
        return ~0;
    return E_interrupt_S_gsi_next++;
}
_private
N
E_interrupt_M( void
){  N idt_n = 32 + E_interrupt_S_gsi_n + 1;
    Mt_( E_interrupt_S_idt, idt_n * 2 );
    if( !E_interrupt_S_idt )
        return ~0;
    E_interrupt_J_interrupt_descriptor( 0, E_interrupt_I_exeception_de, 1 );
    E_interrupt_J_interrupt_descriptor( 1, E_interrupt_I_exeception_db, 1 );
    //E_interrupt_J_interrupt_descriptor( 2, E_interrupt_I_exeception_nmi, 1 );
    E_interrupt_S_idt[ 2 * 2 ] = 0;
    E_interrupt_J_interrupt_descriptor( 3, E_interrupt_I_exeception_bp, 1 );
    E_interrupt_J_interrupt_descriptor( 4, E_interrupt_I_exeception_of, 1 );
    E_interrupt_J_interrupt_descriptor( 5, E_interrupt_I_exeception_br, 1 );
    E_interrupt_J_interrupt_descriptor( 6, E_interrupt_I_exeception_ud, 1 );
    E_interrupt_J_interrupt_descriptor( 7, E_interrupt_I_exeception_nm, 1 );
    E_interrupt_J_interrupt_descriptor( 8, E_interrupt_I_exeception_df, 1 );
    E_interrupt_S_idt[ 9 * 2 ] = 0;
    E_interrupt_J_interrupt_descriptor( 10, E_interrupt_I_exeception_ts, 1 );
    E_interrupt_J_interrupt_descriptor( 11, E_interrupt_I_exeception_np, 1 );
    E_interrupt_J_interrupt_descriptor( 12, E_interrupt_I_exeception_ss, 1 );
    E_interrupt_J_interrupt_descriptor( 13, E_interrupt_I_exeception_gp, 1 );
    E_interrupt_J_interrupt_descriptor( 14, E_interrupt_I_exeception_pf, 1 );
    E_interrupt_S_idt[ 15 * 2 ] = 0;
    E_interrupt_J_interrupt_descriptor( 16, E_interrupt_I_exeception_mf, 1 );
    E_interrupt_J_interrupt_descriptor( 17, E_interrupt_I_exeception_ac, 1 );
    E_interrupt_J_interrupt_descriptor( 18, E_interrupt_I_exeception_mc, 1 );
    E_interrupt_J_interrupt_descriptor( 19, E_interrupt_I_exeception_xm, 1 );
    E_interrupt_J_interrupt_descriptor( 20, E_interrupt_I_exeception_ve, 1 );
    E_interrupt_J_interrupt_descriptor( 21, E_interrupt_I_exeception_cp, 1 );
    for( N i = 22; i != 32; i++ )
        E_interrupt_S_idt[ i * 2 ] = 0;
    Mt_( E_interrupt_S_external, E_interrupt_S_gsi_n );
    if( !E_interrupt_S_external )
    {   W( E_interrupt_S_idt );
        return ~0;
    }
    _0t_( E_interrupt_S_external, E_interrupt_S_gsi_n );
    for( N i = 32; i != 32 + E_interrupt_S_gsi_n; i++ )
        switch(i)
        { case 32:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_32, 0 );
                break;
          case 33:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_33, 0 );
                break;
          case 34:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_34, 0 );
                break;
          case 35:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_35, 0 );
                break;
          case 36:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_36, 0 );
                break;
          case 37:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_37, 0 );
                break;
          case 38:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_38, 0 );
                break;
          case 39:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_39, 0 );
                break;
          case 40:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_40, 0 );
                break;
          case 41:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_41, 0 );
                break;
          case 42:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_42, 0 );
                break;
          case 43:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_43, 0 );
                break;
          case 44:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_44, 0 );
                break;
          case 45:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_45, 0 );
                break;
          case 46:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_46, 0 );
                break;
          case 47:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_47, 0 );
                break;
          case 48:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_48, 0 );
                break;
          case 49:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_49, 0 );
                break;
          case 50:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_50, 0 );
                break;
          case 51:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_51, 0 );
                break;
          case 52:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_52, 0 );
                break;
          case 53:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_53, 0 );
                break;
          case 54:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_54, 0 );
                break;
          case 55:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_55, 0 );
                break;
          case 56:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_56, 0 );
                break;
          case 57:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_57, 0 );
                break;
          case 58:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_58, 0 );
                break;
          case 59:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_59, 0 );
                break;
          case 60:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_60, 0 );
                break;
          case 61:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_61, 0 );
                break;
          case 62:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_62, 0 );
                break;
          case 63:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_63, 0 );
                break;
          case 64:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_64, 0 );
                break;
          case 65:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_65, 0 );
                break;
          case 66:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_66, 0 );
                break;
          case 67:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_67, 0 );
                break;
          case 68:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_68, 0 );
                break;
          case 69:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_69, 0 );
                break;
          case 70:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_70, 0 );
                break;
          case 71:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_71, 0 );
                break;
          case 72:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_72, 0 );
                break;
          case 73:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_73, 0 );
                break;
          case 74:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_74, 0 );
                break;
          case 75:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_75, 0 );
                break;
          case 76:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_76, 0 );
                break;
          case 77:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_77, 0 );
                break;
          case 78:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_78, 0 );
                break;
          case 79:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_79, 0 );
                break;
          case 80:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_80, 0 );
                break;
          case 81:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_81, 0 );
                break;
          case 82:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_82, 0 );
                break;
          case 83:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_83, 0 );
                break;
          case 84:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_84, 0 );
                break;
          case 85:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_85, 0 );
                break;
          case 86:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_86, 0 );
                break;
          case 87:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_87, 0 );
                break;
          case 88:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_88, 0 );
                break;
          case 89:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_89, 0 );
                break;
          case 90:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_90, 0 );
                break;
          case 91:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_91, 0 );
                break;
          case 92:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_92, 0 );
                break;
          case 93:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_93, 0 );
                break;
          case 94:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_94, 0 );
                break;
          case 95:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_95, 0 );
                break;
          case 96:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_96, 0 );
                break;
          case 97:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_97, 0 );
                break;
          case 98:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_98, 0 );
                break;
          case 99:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_99, 0 );
                break;
          case 100:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_100, 0 );
                break;
          case 101:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_101, 0 );
                break;
          case 102:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_102, 0 );
                break;
          case 103:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_103, 0 );
                break;
          case 104:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_104, 0 );
                break;
          case 105:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_105, 0 );
                break;
          case 106:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_106, 0 );
                break;
          case 107:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_107, 0 );
                break;
          case 108:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_108, 0 );
                break;
          case 109:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_109, 0 );
                break;
          case 110:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_110, 0 );
                break;
          case 111:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_111, 0 );
                break;
          case 112:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_112, 0 );
                break;
          case 113:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_113, 0 );
                break;
          case 114:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_114, 0 );
                break;
          case 115:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_115, 0 );
                break;
          case 116:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_116, 0 );
                break;
          case 117:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_117, 0 );
                break;
          case 118:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_118, 0 );
                break;
          case 119:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_119, 0 );
                break;
          case 120:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_120, 0 );
                break;
          case 121:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_121, 0 );
                break;
          case 122:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_122, 0 );
                break;
          case 123:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_123, 0 );
                break;
          case 124:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_124, 0 );
                break;
          case 125:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_125, 0 );
                break;
          case 126:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_126, 0 );
                break;
          case 127:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_127, 0 );
                break;
          case 128:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_128, 0 );
                break;
          case 129:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_129, 0 );
                break;
          case 130:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_130, 0 );
                break;
          case 131:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_131, 0 );
                break;
          case 132:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_132, 0 );
                break;
          case 133:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_133, 0 );
                break;
          case 134:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_134, 0 );
                break;
          case 135:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_135, 0 );
                break;
          case 136:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_136, 0 );
                break;
          case 137:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_137, 0 );
                break;
          case 138:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_138, 0 );
                break;
          case 139:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_139, 0 );
                break;
          case 140:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_140, 0 );
                break;
          case 141:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_141, 0 );
                break;
          case 142:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_142, 0 );
                break;
          case 143:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_143, 0 );
                break;
          case 144:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_144, 0 );
                break;
          case 145:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_145, 0 );
                break;
          case 146:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_146, 0 );
                break;
          case 147:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_147, 0 );
                break;
          case 148:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_148, 0 );
                break;
          case 149:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_149, 0 );
                break;
          case 150:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_150, 0 );
                break;
          case 151:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_151, 0 );
                break;
          case 152:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_152, 0 );
                break;
          case 153:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_153, 0 );
                break;
          case 154:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_154, 0 );
                break;
          case 155:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_155, 0 );
                break;
          case 156:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_156, 0 );
                break;
          case 157:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_157, 0 );
                break;
          case 158:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_158, 0 );
                break;
          case 159:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_159, 0 );
                break;
          case 160:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_160, 0 );
                break;
          case 161:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_161, 0 );
                break;
          case 162:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_162, 0 );
                break;
          case 163:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_163, 0 );
                break;
          case 164:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_164, 0 );
                break;
          case 165:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_165, 0 );
                break;
          case 166:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_166, 0 );
                break;
          case 167:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_167, 0 );
                break;
          case 168:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_168, 0 );
                break;
          case 169:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_169, 0 );
                break;
          case 170:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_170, 0 );
                break;
          case 171:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_171, 0 );
                break;
          case 172:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_172, 0 );
                break;
          case 173:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_173, 0 );
                break;
          case 174:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_174, 0 );
                break;
          case 175:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_175, 0 );
                break;
          case 176:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_176, 0 );
                break;
          case 177:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_177, 0 );
                break;
          case 178:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_178, 0 );
                break;
          case 179:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_179, 0 );
                break;
          case 180:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_180, 0 );
                break;
          case 181:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_181, 0 );
                break;
          case 182:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_182, 0 );
                break;
          case 183:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_183, 0 );
                break;
          case 184:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_184, 0 );
                break;
          case 185:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_185, 0 );
                break;
          case 186:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_186, 0 );
                break;
          case 187:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_187, 0 );
                break;
          case 188:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_188, 0 );
                break;
          case 189:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_189, 0 );
                break;
          case 190:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_190, 0 );
                break;
          case 191:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_191, 0 );
                break;
          case 192:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_192, 0 );
                break;
          case 193:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_193, 0 );
                break;
          case 194:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_194, 0 );
                break;
          case 195:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_195, 0 );
                break;
          case 196:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_196, 0 );
                break;
          case 197:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_197, 0 );
                break;
          case 198:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_198, 0 );
                break;
          case 199:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_199, 0 );
                break;
          case 200:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_200, 0 );
                break;
          case 201:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_201, 0 );
                break;
          case 202:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_202, 0 );
                break;
          case 203:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_203, 0 );
                break;
          case 204:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_204, 0 );
                break;
          case 205:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_205, 0 );
                break;
          case 206:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_206, 0 );
                break;
          case 207:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_207, 0 );
                break;
          case 208:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_208, 0 );
                break;
          case 209:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_209, 0 );
                break;
          case 210:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_210, 0 );
                break;
          case 211:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_211, 0 );
                break;
          case 212:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_212, 0 );
                break;
          case 213:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_213, 0 );
                break;
          case 214:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_214, 0 );
                break;
          case 215:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_215, 0 );
                break;
          case 216:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_216, 0 );
                break;
          case 217:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_217, 0 );
                break;
          case 218:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_218, 0 );
                break;
          case 219:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_219, 0 );
                break;
          case 220:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_220, 0 );
                break;
          case 221:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_221, 0 );
                break;
          case 222:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_222, 0 );
                break;
          case 223:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_223, 0 );
                break;
          case 224:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_224, 0 );
                break;
          case 225:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_225, 0 );
                break;
          case 226:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_226, 0 );
                break;
          case 227:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_227, 0 );
                break;
          case 228:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_228, 0 );
                break;
          case 229:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_229, 0 );
                break;
          case 230:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_230, 0 );
                break;
          case 231:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_231, 0 );
                break;
          case 232:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_232, 0 );
                break;
          case 233:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_233, 0 );
                break;
          case 234:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_234, 0 );
                break;
          case 235:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_235, 0 );
                break;
          case 236:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_236, 0 );
                break;
          case 237:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_237, 0 );
                break;
          case 238:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_238, 0 );
                break;
          case 239:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_239, 0 );
                break;
          case 240:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_240, 0 );
                break;
          case 241:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_241, 0 );
                break;
          case 242:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_242, 0 );
                break;
          case 243:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_243, 0 );
                break;
          case 244:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_244, 0 );
                break;
          case 245:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_245, 0 );
                break;
          case 246:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_246, 0 );
                break;
          case 247:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_247, 0 );
                break;
          case 248:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_248, 0 );
                break;
          case 249:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_249, 0 );
                break;
          case 250:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_250, 0 );
                break;
          case 251:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_251, 0 );
                break;
          case 252:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_252, 0 );
                break;
          case 253:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_253, 0 );
                break;
          case 254:
                E_interrupt_J_interrupt_descriptor( i, E_interrupt_I_external_254, 0 );
                break;
        }
    E_interrupt_J_interrupt_descriptor( 32 + E_interrupt_S_gsi_n, E_interrupt_I_external_spurious, 0 );
    E_interrupt_S_id.base = (N)&E_interrupt_S_idt[0];
    E_interrupt_S_id.limit = idt_n * 2 * sizeof( *E_interrupt_S_idt ) - 1;
    __asm__ volatile (
    "\n"    "lidt   %0"
    :
    : "p" ( &E_interrupt_S_id.limit )
    );
    for_n( i, E_interrupt_S_gsi_n )
        if( ~(S8)E_interrupt_S_gsi[i].source )
            E_interrupt_Q_io_apic_I_enable(i);
    E_interrupt_S_gsi_next = 0;
    E_interrupt_S_gsi_timer = E_interrupt_R_gsi_next();
    if( !~E_interrupt_S_gsi_timer )
        return ~0;
    E_interrupt_S_gsi_ipi = E_interrupt_R_gsi_next();
    if( !~E_interrupt_S_gsi_ipi )
        return ~0;
    // Kalibracja zegara APIC na podstawie RTC.
    E_interrupt_S_external[16] = &E_interrupt_I_apic_timer_interrupt;
    E_interrupt_P( 8, &E_interrupt_I_rtc_interrupt_1 );
    E_interrupt_Q_local_apic_P( 0xf, ( E_interrupt_Q_local_apic_R( 0xf ) & ~0xff ) | 0x100 | ( 32 + E_interrupt_S_gsi_n ));
    E_interrupt_Q_local_apic_P( 0x32, ( 32 + 16 ) | ( 1 << 17 ));
    E_interrupt_Q_local_apic_P( 0x3e, ( E_interrupt_Q_local_apic_R( 0x3e ) & ~0xf ) | 0xb );
    E_main_I_out_8( 0x70, 0x8a );
    N8 v = E_main_I_in_8( 0x71 );
    E_main_I_out_8( 0x70, 0x8a );
    E_main_I_out_8( 0x71, ( v & 0xf0 ) | 0xf );
    E_main_I_out_8( 0x70, 0x8b );
    v = E_main_I_in_8( 0x71 );
    E_main_I_out_8( 0x70, 0x8b );
    E_main_I_out_8( 0x71, v | 0x40 );
    E_main_I_out_8( 0x70, 0xc );
    E_main_I_in_8( 0x71 );
    E_interrupt_S_apic_timer_ticks = E_interrupt_S_rtc_ticks = 0;
    __asm__ volatile (
    "\n"    "sti"
    );
    while( E_interrupt_S_rtc_ticks < 1 + 1 )
        __asm__ volatile (
        "\n"    "pause"
        );
    __asm__ volatile (
    "\n"    "cli"
    );
    E_interrupt_P( 8, &E_interrupt_I_rtc_interrupt_2 );
    E_interrupt_S_apic_timer_freq = 0;
    E_interrupt_S_apic_timer_div = 1ULL << E_asm_I_bsr( E_interrupt_S_cpu_freq );
    O{  E_interrupt_S_apic_timer_ticks = E_interrupt_S_rtc_ticks = 0;
        __asm__ volatile (
        "\n"    "sti"
        );
        while( E_interrupt_S_rtc_ticks < 1 + 1 )
            __asm__ volatile (
            "\n"    "pause"
            );
        __asm__ volatile (
        "\n"    "cli"
        );
        E_interrupt_Q_local_apic_P( 0x38, 0 );
        if( E_interrupt_S_apic_timer_freq << 1 > E_interrupt_S_apic_timer_freq_ )
        {   E_interrupt_S_apic_timer_div <<= 1;
            break;
        }
        E_interrupt_S_apic_timer_freq = E_interrupt_S_apic_timer_freq_;
        if( E_interrupt_S_apic_timer_div == 1 )
            break;
        E_interrupt_S_apic_timer_div >>= 1;
    }
    E_main_I_out_8( 0x70, 0x8b );
    v = E_main_I_in_8( 0x71 );
    E_main_I_out_8( 0x70, 0x8b );
    E_main_I_out_8( 0x71, v & ~0x40 );
    E_main_I_out_8( 0x70, 0xc );
    E_main_I_in_8( 0x71 );
    E_interrupt_Q_local_apic_P( 0x32, 32 + E_interrupt_S_gsi_timer );
    E_interrupt_P( 8, 0 );
    E_interrupt_S_external[16] = 0;
    __asm__ volatile (
    "\n"    "sti"
    );
    E_interrupt_S_cpu_freq *= 2;
    E_interrupt_S_apic_timer_freq *= E_interrupt_S_apic_timer_div * 2;
    E_interrupt_S_apic_timer_tick_time = E_interrupt_S_cpu_freq / E_interrupt_S_apic_timer_freq;
    return 0;
}
/******************************************************************************/
